(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[0],{17:function(e,t,n){},26:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(19),i=n.n(a),r=(n(26),n(2)),s=n.n(r),o=n(7),l=n(6),u=(n(17),n(11)),d=n(3),j=n(4),h=n(0);var b=function(e){return Object(h.jsxs)("div",{className:"hikeCardAdmin",children:[Object(h.jsx)("img",{src:e.imageUrl,alt:""}),Object(h.jsx)("h3",{children:e.title}),Object(h.jsx)("p",{children:e.uuid})]})};var p=function(e){var t=e.show?"modal display-block":"modal display-none",n=Object(c.useRef)(),a=function(t){"Escape"===t.code&&(e.handleClose(),e.closeEditing())},i=function(t){n.current.contains(t.target)||(e.handleClose(),e.closeEditing())};return Object(c.useEffect)((function(){return document.addEventListener("keydown",a),document.addEventListener("mousedown",i),function(){document.removeEventListener("keydown",a),document.removeEventListener("mousedown",i)}}),[]),Object(h.jsx)("div",{className:t,children:Object(h.jsxs)("section",{ref:n,className:"modal-main",children:[e.children,Object(h.jsx)("button",{type:"button",onClick:e.handleClose,children:"Close"})]})})};var O=function(e){return Object(h.jsx)(h.Fragment,{children:e.isEditing?Object(h.jsx)("span",{className:"modalInputField",children:e.children}):Object(h.jsx)("span",{children:e.title})})};var x=function(e){var t=localStorage.getItem("sessionId"),n=Object(c.useState)([]),a=Object(l.a)(n,2),i=a[0],r=a[1],u=Object(c.useState)(!1),d=Object(l.a)(u,2),x=d[0],f=d[1],g=Object(c.useState)(!1),m=Object(l.a)(g,2),v=m[0],k=m[1],w=Object(c.useState)({}),y=Object(l.a)(w,2),C=y[0],E=y[1],I=Object(c.useState)(!1),S=Object(l.a)(I,2),N=S[0],H=S[1],U=Object(c.useState)({title:"",imageUrl:"",date:"",description:"",location:""}),D=Object(l.a)(U,2),L=D[0],T=D[1];Object(c.useEffect)((function(){return A()}),[]),Object(c.useEffect)((function(){if(null===C||void 0===C?void 0:C.uuid){var e=R(C.uuid);E(e)}}),[i]);var A=function(){var n=Object(o.a)(s.a.mark((function n(){var c,a,i,o;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c={error:"unknown"},a="https://wbshikingclub.herokuapp.com/api/hikes"+"?session=".concat(t),n.prev=2,n.next=5,fetch(a,{cache:"no-cache"});case 5:if(!(i=n.sent).ok){n.next=14;break}return n.next=9,i.json();case 9:c=n.sent,o=c.map((function(e){return{title:e.title||"",description:e.description||"",location:e.location||"",uuid:e.uuid,imageUrl:e.imageUrl||"https://via.placeholder.com/150",date:e.date||(new Date).toLocaleDateString("fr-ca")}})),r(o),n.next=15;break;case 14:e.logOut();case 15:n.next=22;break;case 17:n.prev=17,n.t0=n.catch(2),console.log(n.t0),c.error=n.t0.message,e.logOut();case 22:return n.abrupt("return",c);case 23:case"end":return n.stop()}}),n,null,[[2,17]])})));return function(){return n.apply(this,arguments)}}(),F=function(){f(!1),k(!1)},R=function(e){return i.find((function(t){return t.uuid===e}))},J=function(e){f(!0);var t=R(e);E(t)},_=function(e){return new Date(e).toLocaleDateString("fr-ca")},B=function(){T({title:"",imageUrl:"",date:"",description:"",location:""}),H(!1)},P=function(){var e=Object(o.a)(s.a.mark((function e(n,c){var a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://wbshikingclub.herokuapp.com/api/hikes",a="".concat("https://wbshikingclub.herokuapp.com/api/hikes","/").concat(c,"?session=").concat(t),i={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=5,fetch(a,i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(L,t);case 2:B(),F(),A();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(o.a)(s.a.mark((function e(n){var c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://wbshikingclub.herokuapp.com/api/hikes",c="".concat("https://wbshikingclub.herokuapp.com/api/hikes","/").concat(n,"?session=").concat(t),a={method:"DELETE",headers:{"Content-Type":"application/json"}},F(),e.next=6,fetch(c,a);case 6:return e.next=8,A();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t);case 2:B();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(o.a)(s.a.mark((function e(n){var c,a,i,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="https://wbshikingclub.herokuapp.com/api/hikes"+"?session=".concat(t),i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=4,fetch(c,i);case 4:if(!(r=e.sent).ok){e.next=10;break}return e.next=8,r.json();case 8:a=e.sent,T(a);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(L);case 2:A(),F(),B();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=Object(h.jsx)("div",{});return x?G=Object(h.jsxs)(p,{show:x,closeEditing:B,handleClose:F,children:[Object(h.jsx)("div",{className:"modalImage",children:Object(h.jsx)("img",{src:C.imageUrl,alt:"hike"})}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike UUID: "})," ",Object(h.jsx)("span",{children:C.uuid})]}),Object(h.jsxs)("div",{className:"modalButtons",children:[N?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{onClick:function(){return B()},children:"Cancel"}),Object(h.jsx)("button",{onClick:function(){return M(C.uuid)},children:"Update"})]}):Object(h.jsx)("button",{onClick:function(){T(C),H(!0)},children:"Edit Hike Info"}),Object(h.jsx)("button",{onClick:function(){return K(C.uuid)},children:"!!! DELETE HIKE !!!"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Title: "}),Object(h.jsx)(O,{isEditing:N,title:C.title,children:Object(h.jsx)("input",{type:"text",placeholder:C.title,value:L.title,onChange:function(e){T(Object(j.a)(Object(j.a)({},L),{},{title:e.target.value}))}})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Image URL: "}),Object(h.jsx)(O,{isEditing:N,title:C.imageUrl,children:Object(h.jsx)("input",{type:"text",placeholder:C.imageUrl,value:L.imageUrl,onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{imageUrl:e.target.value}))}})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Date: "}),Object(h.jsx)(O,{isEditing:N,title:_(C.date),children:Object(h.jsx)("input",{type:"date",placeholder:_(C.date),value:_(L.date),onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{date:e.target.value}))}})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Description: "}),Object(h.jsx)(O,{isEditing:N,title:C.description,children:Object(h.jsx)("textarea",{type:"text",placeholder:C.description,value:L.description,onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{description:e.target.value}))}})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Location: "}),Object(h.jsx)(O,{isEditing:N,title:C.location,children:Object(h.jsx)("input",{type:"text",placeholder:C.location,value:L.location,onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{location:e.target.value}))}})})]})]}):v&&(G=Object(h.jsxs)(p,{create:V,show:v,closeEditing:B,handleClose:F,children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Title: "}),Object(h.jsx)("span",{className:"modalInputField",children:Object(h.jsx)("input",{type:"text",value:L.title,onChange:function(e){T(Object(j.a)(Object(j.a)({},L),{},{title:e.target.value}))}})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Image URL: "}),Object(h.jsxs)("span",{className:"modalInputField",children:[" ",Object(h.jsx)("input",{type:"text",value:L.imageUrl,onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{imageUrl:e.target.value}))}})]})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Date: "}),Object(h.jsxs)("span",{className:"modalInputField",children:[" ",Object(h.jsx)("input",{type:"date",value:_(L.date),onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{date:e.target.value}))}})]})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Description: "}),Object(h.jsx)("span",{className:"modalInputField",children:Object(h.jsx)("textarea",{type:"text",value:L.description,onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{description:e.target.value}))}})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{children:"Hike Location: "}),Object(h.jsxs)("span",{className:"modalInputField",children:[" ",Object(h.jsx)("input",{type:"text",value:L.location,onChange:function(e){return T(Object(j.a)(Object(j.a)({},L),{},{location:e.target.value}))}})]})]}),Object(h.jsx)("button",{type:"button",onClick:function(){H(!0),q()},children:"Create"})]})),Object(h.jsxs)("div",{className:"hikeList",children:[Object(h.jsx)("button",{className:"createButton",onClick:function(){k(!0)},children:"Create a new hike"}),i.map((function(e){return Object(h.jsx)("div",{onClick:function(){f(!0),J(e.uuid)},children:Object(h.jsx)(b,{title:e.title,uuid:e.uuid,imageUrl:e.imageUrl})},e.uuid)})),G]})};var f=function(){return Object(h.jsxs)("div",{children:["To add, remove or edit News articles, please go to ",Object(h.jsx)("a",{href:"https://www.contentful.com/",children:"Contentful"})]})};var g=function(e){return Object(h.jsxs)("div",{className:"registrationCardAdmin",children:[Object(h.jsxs)("p",{children:["Email: ",e.email]}),Object(h.jsxs)("p",{children:["Name: ",e.name]}),Object(h.jsxs)("p",{children:["Message: ",e.message]}),Object(h.jsxs)("p",{children:["HikeID: ",e.hikeId]}),Object(h.jsxs)("p",{children:["Hike Title: ",e.hikeTitle]}),Object(h.jsxs)("p",{children:["Added on: ",new Date(e.dateAdded).toLocaleDateString("fr-CA")]}),e.children]})};var m=function(e){var t=localStorage.getItem("sessionId"),n=Object(c.useState)([]),a=Object(l.a)(n,2),i=a[0],r=a[1],u=Object(c.useState)([]),d=Object(l.a)(u,2),j=d[0],b=d[1],p=Object(c.useState)("allHikes"),O=Object(l.a)(p,2),x=O[0],f=O[1],m=function(){var n=Object(o.a)(s.a.mark((function n(){var c,a,i,o;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c={error:"unknown"},a="https://wbshikingclub.herokuapp.com/api/hikes"+"/registrations?session=".concat(t),n.prev=2,n.next=5,fetch(a,{cache:"no-cache"});case 5:if(!(i=n.sent).ok){n.next=14;break}return n.next=9,i.json();case 9:c=n.sent,o=c.map((function(e){return{name:e.name,email:e.email,message:e.message,hikeId:e.hike_uuid,hikeTitle:e.hike_title,dateAdded:e.date_added,id:e.id}})),r(o),n.next=15;break;case 14:e.logOut();case 15:n.next=22;break;case 17:n.prev=17,n.t0=n.catch(2),console.log(n.t0),c.error=n.t0.message,e.logOut();case 22:return n.abrupt("return",c);case 23:case"end":return n.stop()}}),n,null,[[2,17]])})));return function(){return n.apply(this,arguments)}}(),v=function(){var e=Object(o.a)(s.a.mark((function e(){var n,c,a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={error:"unknown"},c="https://wbshikingclub.herokuapp.com/api/hikes"+"?session=".concat(t),e.prev=2,e.next=5,fetch(c,{cache:"no-cache"});case 5:if(!(a=e.sent).ok){e.next=12;break}return e.next=9,a.json();case 9:n=e.sent,i=n.map((function(e){return{title:e.title||"",uuid:e.uuid,date:e.date||(new Date).toLocaleDateString("fr-ca")}})),b(i);case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0),n.error=e.t0.message;case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){v(),m()}),[]),Object(c.useEffect)((function(){y()}),[x]);var k=function(){var e=Object(o.a)(s.a.mark((function e(n){var c,a,i,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={error:"unknown"},a="https://wbshikingclub.herokuapp.com/api/hikes"+"/".concat(n,"?session=").concat(t),e.prev=2,e.next=5,fetch(a,{cache:"no-cache"});case 5:if(!(i=e.sent).ok){e.next=13;break}return e.next=9,i.json();case 9:c=e.sent,o=c.registrations.map((function(e){return{name:e.name,email:e.email,message:e.message,hikeId:e.hike_uuid,hikeTitle:c.title,dateAdded:e.date_added,id:e.id}})),l=o.sort((function(e,t){return(e=Date.parse(e.dateAdded))>(t=Date.parse(t.dateAdded))?-1:e<t?1:e===t?0:void 0})),r(l);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0),c.error=e.t0.message;case 19:return e.abrupt("return",c.registrations);case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(o.a)(s.a.mark((function e(n){var c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://wbshikingclub.herokuapp.com/api/hikes",c="".concat("https://wbshikingclub.herokuapp.com/api/hikes","/registrations/").concat(n,"?session=").concat(t),a={method:"DELETE",headers:{"Content-Type":"application/json"}},e.next=5,fetch(c,a);case 5:return e.next=7,y();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function y(){return C.apply(this,arguments)}function C(){return(C=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("allHikes"!==x){e.next=5;break}return e.next=3,m();case 3:e.next=7;break;case 5:return e.next=7,k(x);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"hikesDropdown",children:"See registrations for hike:"}),Object(h.jsxs)("select",{id:"hikesDropdown",name:"hikes",onChange:function(e){f(e.target.value)},children:[Object(h.jsx)("option",{defaultValue:!0,value:"allHikes",children:"All hikes"}),j.map((function(e){return Object(h.jsxs)("option",{value:e.uuid,children:[e.title," (",e.uuid,")"]},"option"+e.uuid)}))]}),Object(h.jsx)("div",{className:"registrationsList",children:i.map((function(e){return Object(h.jsx)("div",{children:Object(h.jsx)(g,{id:e.id,email:e.email,name:e.name,message:e.message,hikeId:e.hikeId,hikeTitle:e.hikeTitle,dateAdded:e.dateAdded,children:Object(h.jsx)("button",{className:"deleteRegistration",onClick:function(){return w(e.id)},children:"Delete"})})},e.id)}))})]})};var v=function(e){var t,n=Object(c.useState)(""),a=Object(l.a)(n,2),i=a[0],r=a[1],s=Object(c.useState)(""),o=Object(l.a)(s,2),u=o[0],d=o[1];return""!==e.errorState?(console.log(e.errorState),t=Object(h.jsx)("div",{className:"errorMessage",children:e.errorState})):t=Object(h.jsx)("div",{}),Object(h.jsxs)("div",{className:"Login",children:[t,Object(h.jsx)("input",{type:"text",placeholder:"E-Mail",value:i,onChange:function(e){r(e.target.value)}}),Object(h.jsx)("input",{type:"text",placeholder:"Password",value:u,onChange:function(e){d(e.target.value)}}),Object(h.jsx)("button",{onClick:function(){e.login(i,u)},children:"Log in"})]})};var k=function(e){return Object(h.jsx)("div",{children:Object(h.jsxs)(d.d,{children:[Object(h.jsx)(d.b,{exact:!0,path:"/login",children:e.loggedIn?Object(h.jsx)(d.a,{to:"/hikes"}):Object(h.jsx)(v,{login:e.login,errorState:e.errorState})}),Object(h.jsx)(d.b,{exact:!0,path:"/",children:e.loggedIn?Object(h.jsx)(d.a,{to:"/hikes"}):Object(h.jsx)(d.a,{to:"/login"})}),Object(h.jsx)(d.b,{path:"/hikes",children:e.loggedIn?Object(h.jsx)(x,{logOut:e.logOut,loggedIn:e.loggedIn}):Object(h.jsx)(d.a,{to:"/login"})}),Object(h.jsx)(d.b,{path:"/news",children:e.loggedIn?Object(h.jsx)(f,{}):Object(h.jsx)(d.a,{to:"/login"})}),Object(h.jsx)(d.b,{path:"/registrations",children:e.loggedIn?Object(h.jsx)(m,{logOut:e.logOut}):Object(h.jsx)(d.a,{to:"/login"})})]})})};var w=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)(""),r=Object(l.a)(i,2),d=r[0],j=r[1],b=function(){var e=Object(o.a)(s.a.mark((function e(t,n){var c,i,r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),console.log(n),c={error:"unknown"},i=p()+"/login",r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})},e.next=7,fetch(i,r);case 7:if(!(o=e.sent).ok){e.next=15;break}return e.next=11,o.json();case 11:"admin"===(c=e.sent).userRole?(localStorage.setItem("sessionId",c.sessionId),a(!0),j("")):j("unauthorized User"),e.next=18;break;case 15:j("login unsuccessful. Username or password was wrong."),console.log("login unsuccessful"),O();case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();console.log("Hey it's loading"),Object(c.useEffect)((function(){localStorage.getItem("sessionId")&&(console.log("Hey this one is inside the useEffect"),a(!0))}),[]),console.log("Hey it's loading after useEffect");var p=function(){return console.log("Hey this is inside the envUrl"),"https://wbshikingclub.herokuapp.com"};console.log("Hey it's loading after the envUrl");var O=function(){localStorage.clear(),a(!1)};return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)("header",{className:"App-header",children:Object(h.jsxs)("nav",{className:"NavButtons",children:[Object(h.jsx)("div",{className:"logout",children:Object(h.jsx)("button",{onClick:O,children:"Log out"})}),Object(h.jsx)(u.b,{to:"/hikes",activeClassName:"selected",children:"Hikes"}),Object(h.jsx)(u.b,{to:"/news",activeClassName:"selected",children:"News"}),Object(h.jsx)(u.b,{to:"/registrations",activeClassName:"selected",children:"Registrations"})]})}),Object(h.jsx)(k,{login:b,loggedIn:n,logOut:O,errorState:d})]})};i.a.render(Object(h.jsx)(u.a,{basename:"/hikingclub-admin",children:Object(h.jsx)(w,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.191f983a.chunk.js.map